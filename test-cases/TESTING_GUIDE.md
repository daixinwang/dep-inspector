# 测试指南
本文档提供了详细的测试步骤和验证方法。

## 快速开始

### 1. 准备测试文件

运行批量打包脚本：

```bash
cd test-cases
./create-test-zips.sh
```

这将创建以下 ZIP 文件：
- `case1-simple-cycle/case1-simple-cycle.zip`
- `case2-multiple-cycles/case2-multiple-cycles.zip`
- `case3-complex-cycle/case3-complex-cycle.zip`
- `case4-no-cycle/case4-no-cycle.zip`

### 2. 启动应用

```bash
cd ..
npm run dev
```

### 3. 在浏览器中打开

访问 `http://localhost:5173`

---

## 详细测试步骤

### 测试用例 1：简单循环

#### 步骤

1. 在首页点击上传区域
2. 选择 `case1-simple-cycle.zip`
3. 等待分析完成

#### 验证点

**首页统计卡片**：
- [ ] 项目文件：3
- [ ] 依赖关系：3
- [ ] 循环依赖：1（红色显示）

**依赖图页面**：
- [ ] 显示 3 个节点（A、B、C）
- [ ] 所有节点都是红色（表示在循环中）
- [ ] 显示 3 条边（A→B, B→C, C→A）
- [ ] 点击"仅循环"按钮，图表不变（因为所有节点都在循环中）

**循环依赖页面**：
- [ ] 显示 1 个循环
- [ ] 循环路径：包含 A、B、C
- [ ] 涉及文件数：3
- [ ] 展开后显示完整路径和解决建议

**统计分析页面**：
- [ ] 总节点数：3
- [ ] 总依赖数：3
- [ ] 平均度数：1.00
- [ ] 循环依赖：1
- [ ] 涉及循环的文件：3（100%）

#### 预期结果

```
✓ 检测到 1 个循环
✓ 循环路径：A.ts → B.ts → C.ts → A.ts
✓ 所有节点都标记为循环依赖
```

---

### 测试用例 2：多个循环

#### 步骤

1. 在首页点击上传区域
2. 选择 `case2-multiple-cycles.zip`
3. 等待分析完成

#### 验证点

**首页统计卡片**：
- [ ] 项目文件：4
- [ ] 依赖关系：4
- [ ] 循环依赖：2（红色显示）

**依赖图页面**：
- [ ] 显示 4 个节点（A、B、C、D）
- [ ] 所有节点都是红色
- [ ] 显示 4 条边（A→B, B→A, C→D, D→C）
- [ ] 两组节点之间没有连接

**循环依赖页面**：
- [ ] 显示 2 个循环
- [ ] 循环 1：A ⇄ B
- [ ] 循环 2：C ⇄ D
- [ ] 每个循环涉及 2 个文件

**统计分析页面**：
- [ ] 总节点数：4
- [ ] 总依赖数：4
- [ ] 循环依赖：2
- [ ] 涉及循环的文件：4（100%）

#### 预期结果

```
✓ 检测到 2 个独立的循环
✓ 循环 1：A.ts → B.ts → A.ts
✓ 循环 2：C.ts → D.ts → C.ts
✓ 两个循环之间没有依赖关系
```

---

### 测试用例 3：复杂循环

#### 步骤

1. 在首页点击上传区域
2. 选择 `case3-complex-cycle.zip`
3. 等待分析完成

#### 验证点

**首页统计卡片**：
- [ ] 项目文件：4
- [ ] 依赖关系：5
- [ ] 循环依赖：1 或 2

**依赖图页面**：
- [ ] 显示 4 个节点（A、B、C、D）
- [ ] 所有节点都是红色
- [ ] 显示 5 条边（A→B, A→C, B→C, C→D, D→A）
- [ ] 可以看到多条路径形成循环

**循环依赖页面**：
- [ ] 显示至少 1 个循环
- [ ] 循环包含所有 4 个节点
- [ ] 可能显示多个循环路径

**统计分析页面**：
- [ ] 总节点数：4
- [ ] 总依赖数：5
- [ ] 平均度数：1.25
- [ ] 涉及循环的文件：4（100%）

#### 预期结果

```
✓ 检测到循环（可能是 1 个或 2 个）
✓ 可能的路径：
  - A.ts → B.ts → C.ts → D.ts → A.ts
  - A.ts → C.ts → D.ts → A.ts
✓ 所有节点都在循环中
```

---

### 测试用例 4：无循环

#### 步骤

1. 在首页点击上传区域
2. 选择 `case4-no-cycle.zip`
3. 等待分析完成

#### 验证点

**首页统计卡片**：
- [ ] 项目文件：3
- [ ] 依赖关系：2
- [ ] 循环依赖：0（绿色显示）

**依赖图页面**：
- [ ] 显示 3 个节点（A、B、C）
- [ ] 所有节点都是蓝色（正常节点）
- [ ] 显示 2 条边（A→B, B→C）
- [ ] 点击"仅循环"按钮，图表为空（因为没有循环）

**循环依赖页面**：
- [ ] 显示"恭喜！"消息
- [ ] 提示"项目中没有发现循环依赖"
- [ ] 显示绿色的成功图标

**统计分析页面**：
- [ ] 总节点数：3
- [ ] 总依赖数：2
- [ ] 平均度数：0.67
- [ ] 循环依赖：0
- [ ] 涉及循环的文件：0（0%）

#### 预期结果

```
✓ 没有检测到循环
✓ 依赖关系：A.ts → B.ts → C.ts
✓ 所有节点都是正常状态
✓ 这是一个健康的依赖结构
```

---

## 性能测试

### 测试目标

验证算法的时间复杂度是否符合 O(V + E)。

### 测试方法

1. 记录每个测试用例的分析时间
2. 计算 V + E 的值
3. 验证时间与 V + E 成正比

### 预期结果

| 测试用例 | V | E | V+E | 预期时间 | 实际时间 |
|---------|---|---|-----|---------|---------|
| Case 1  | 3 | 3 | 6   | < 5ms   | [填写]  |
| Case 2  | 4 | 4 | 8   | < 5ms   | [填写]  |
| Case 3  | 4 | 5 | 9   | < 5ms   | [填写]  |
| Case 4  | 3 | 2 | 5   | < 5ms   | [填写]  |

---

## 边界测试

### 空项目

**测试**：上传一个空的 ZIP 文件

**预期**：
- 显示错误提示
- 或显示"没有找到源代码文件"

### 单个文件

**测试**：上传只包含一个文件的项目

**预期**：
- 节点数：1
- 边数：0
- 循环数：0

### 自循环

**测试**：创建一个文件导入自己

```typescript
// A.ts
import { functionA } from './A';
```

**预期**：
- 检测到 1 个循环
- 循环路径：A → A

---

## 故障排查

### 问题 1：上传后没有反应

**可能原因**：
- ZIP 文件格式不正确
- 没有 `src/` 目录
- 文件扩展名不支持

**解决方法**：
1. 检查 ZIP 文件结构
2. 确保包含 `src/` 目录
3. 检查文件扩展名

### 问题 2：循环数量不对

**可能原因**：
- 算法的去重逻辑有问题
- 循环规范化处理不正确

**解决方法**：
1. 查看浏览器控制台
2. 检查循环检测算法
3. 验证去重逻辑

### 问题 3：可视化显示异常

**可能原因**：
- vis-network 配置问题
- 数据格式不正确

**解决方法**：
1. 刷新页面
2. 重新上传文件
3. 检查浏览器控制台错误

---

## 测试报告模板

### 测试信息

- **测试日期**：[填写日期]
- **测试人员**：[填写姓名]
- **应用版本**：[填写版本]
- **浏览器**：[填写浏览器和版本]

### 测试结果

| 测试用例 | 通过 | 失败 | 备注 |
|---------|------|------|------|
| Case 1  | ☐    | ☐    |      |
| Case 2  | ☐    | ☐    |      |
| Case 3  | ☐    | ☐    |      |
| Case 4  | ☐    | ☐    |      |

### 发现的问题

1. [问题描述]
   - 严重程度：[高/中/低]
   - 复现步骤：[步骤]
   - 预期结果：[描述]
   - 实际结果：[描述]

### 改进建议

1. [建议内容]

---

## 自动化测试

### 未来计划

可以考虑添加自动化测试：

```typescript
describe('Cycle Detection', () => {
  it('should detect simple cycle', () => {
    const graph = loadTestCase('case1-simple-cycle');
    const cycles = findCycles(graph);
    expect(cycles.length).toBe(1);
    expect(cycles[0].nodes.length).toBe(3);
  });

  it('should detect multiple cycles', () => {
    const graph = loadTestCase('case2-multiple-cycles');
    const cycles = findCycles(graph);
    expect(cycles.length).toBe(2);
  });

  // ... 更多测试
});
```

---

**最后更新**：2025年11月30日
